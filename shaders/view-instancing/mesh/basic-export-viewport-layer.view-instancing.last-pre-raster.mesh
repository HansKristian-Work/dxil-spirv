struct VOut
{
	float4 pos : SV_Position;
	float b : B;
};

struct PrimOut
{
	uint layer : SV_RenderTargetArrayIndex;
	uint vp : SV_ViewportArrayIndex;
};

[numthreads(2, 3, 4)]
[outputtopology("triangle")]
void main(uint tid : SV_GroupIndex,
		out vertices VOut vout[24],
		out indices uint3 ind[8], out primitives PrimOut prims[8], uint vid : SV_ViewID)
{
	SetMeshOutputCounts(24, 8);
	vout[tid].pos = float(tid).xxxx;
	vout[tid].b = float(tid ^ 1);

	if (tid < 8)
	{
		ind[tid] = 3 * tid + uint3(0, 1, 2);
		prims[tid].layer = vid;
		prims[tid].vp = vid + 1;
	}
}
